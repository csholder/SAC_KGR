Model directory exists: D:\Documents\codes\python\KnowledgeGraph\LinkPredict\SAC_KGR\model\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0
2022-06-29 12:32:53,871 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - {'process_data': False, 'train': True, 'inference': False, 'run_analysis': True, 'data_dir': '../data/FB15K-237_20', 'model_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\model\\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0', 'model_root_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\model', 'log_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\log', 'checkpoint_path': None, 'gpu': 0, 'seed': 543, 'best_dev_metrics': 0.0, 'add_reverse_relations': True, 'add_reversed_training_edges': False, 'emb_dropout_rate': 0.3, 'group_examples_by_query': False, 'entity_dim': 100, 'relation_dim': 100, 'history_dim': 200, 'history_num_layers': 3, 'use_action_space_bucketing': True, 'bucket_interval': 10, 'test': False, 'learning_rate': 0.001, 'actor_learning_rate': 0.001, 'critic_learning_rate': 0.001, 'eof_learning_rate': 0.001, 'num_epochs': 2, 'num_wait_epochs': 100, 'num_peek_epochs': 2, 'start_epoch': 0, 'train_batch_size': 4, 'eval_batch_size': 32, 'buffer_batch_size': 64, 'train_freq_value': 3, 'train_freq_unit': 'episode', 'gradient_steps': 3, 'grad_norm': 0.0, 'xavier_initialization': True, 'hidden_dropout_rate': 0.3, 'feat_dropout_rate': 0.2, 'emb_2D_d1': 10, 'emb_2D_d2': 10, 'num_out_channels': 32, 'kernel_size': 3, 'label_smoothing_epsilon': 0.1, 'num_negative_samples': 100, 'conve_state_dict_path': '../model/FB15K-237_20-embed.conve-RV-100-100-0.003-2-100/model_best.tar', 'theta': 0.2, 'model_name': 'rl.dqn', 'num_rollouts': 3, 'num_rollout_steps': 3, 'bandwidth': 400, 'relation_only': True, 'policy_class': 'DQNPolicy', 'baseline': 'na', 'ff_dropout_rate': 0.1, 'rnn_dropout_rate': 0.0, 'action_dropout_rate': 0.5, 'activation_fn': 'relu', 'net_arch': [64, 64], 'verbose': 0, 'exploration_initial_eps': 1.0, 'exploration_final_eps': 0.05, 'exploration_fraction': 0.1, 'buffer_size': 2880, 'replay_buffer_class': 'ReplayBuffer', 'beta': 0.0, 'gamma': 1, 'tau': 0.005, 'learning_starts': 3, 'target_update_interval': 1, 'ent_coef': 'auto_0.01', 'share_features_extractor': False, 'target_entropy': 'auto', 'n_critics': 1, 'fn_state_dict_path': '', 'fn_kg_state_dict_path': '', 'reward_shaping_threshold': 0, 'mu': 1.0, 'beam_size': 2, 'mask_test_false_negatives': False, 'visualize_paths': False, 'save_beam_search_paths': False, 'remark': '0', 'device': device(type='cuda', index=0)}
** Create rl.dqn knowledge graph **
Sanity check: 14543 entities loaded
Sanity check: 477 relations loaded
Sanity check: maximum out degree: 1459
Sanity check: 108846 facts in knowledge graph
Sanity check: 106444 facts saved in action table
Vectorizing action spaces bucket 1...
Vectorizing action spaces bucket 41...
Vectorizing action spaces bucket 37...
Vectorizing action spaces bucket 27...
Vectorizing action spaces bucket 40...
Vectorizing action spaces bucket 39...
Vectorizing action spaces bucket 16...
Vectorizing action spaces bucket 36...
Vectorizing action spaces bucket 18...
Vectorizing action spaces bucket 19...
Vectorizing action spaces bucket 20...
Vectorizing action spaces bucket 21...
Vectorizing action spaces bucket 14...
Vectorizing action spaces bucket 15...
Vectorizing action spaces bucket 23...
Vectorizing action spaces bucket 12...
Vectorizing action spaces bucket 13...
Vectorizing action spaces bucket 11...
Vectorizing action spaces bucket 9...
Vectorizing action spaces bucket 10...
Vectorizing action spaces bucket 8...
Vectorizing action spaces bucket 7...
Vectorizing action spaces bucket 6...
Vectorizing action spaces bucket 5...
Vectorizing action spaces bucket 4...
Vectorizing action spaces bucket 3...
Vectorizing action spaces bucket 2...
Training:   2%|▏         | 4/200 [00:00<00:35,  5.47it/s]
========================== LFramework ==========================
model_name:  rl.dqn
start_epoch:  0
num_epochs:  2
train_batch_size:  4
eval_batch_size:  32
num_rollouts:  3
beam_size:  2
run_analysis:  True
num_peek_epochs:  2
num_wait_epochs:  100
use_action_space_bucketing:  True
========================== MLPFeaturesExtractor ==========================
_action_dim:  200
_history_dim:  200
_features_dim:  200
_state_dim:  300
_history_num_layers:  3
_xavier_initialization:  True
ff_dropout_rate:  0.1
========================== MLPFeaturesExtractor ==========================
_action_dim:  200
_history_dim:  200
_features_dim:  200
_state_dim:  300
_history_num_layers:  3
_xavier_initialization:  True
ff_dropout_rate:  0.1
800 triples loaded from ../data/FB15K-237_20\train.txt
500 triples loaded from ../data/FB15K-237_20\dev.txt
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] -
Model Parameters
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - --------------------------
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - kg.entity_embeddings.weight	1454300	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - kg.relation_embeddings.weight	47700	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W1.weight	60000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W1.bias	200	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W2.weight	40000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W2.bias	200	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l0	160000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l0	160000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l0	800	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l0	800	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l1	160000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l1	160000	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l1	800	requires_grad=True
2022-06-29 12:33:08,940 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l1	800	requires_grad=True
2022-06-29 12:33:08,941 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l2	160000	requires_grad=True
2022-06-29 12:33:08,941 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l2	160000	requires_grad=True
2022-06-29 12:33:08,941 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l2	800	requires_grad=True
2022-06-29 12:33:08,941 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l2	800	requires_grad=True
2022-06-29 12:33:08,941 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.0.weight	25600	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.0.bias	64	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.2.weight	4096	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.2.bias	64	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.4.weight	64	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.4.bias	1	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W1.weight	60000	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W1.bias	200	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W2.weight	40000	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W2.bias	200	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l0	160000	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l0	160000	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l0	800	requires_grad=True
2022-06-29 12:33:08,943 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l0	800	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l1	160000	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l1	160000	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l1	800	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l1	800	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l2	160000	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l2	160000	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l2	800	requires_grad=True
2022-06-29 12:33:08,944 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l2	800	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.0.weight	25600	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.0.bias	64	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.2.weight	4096	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.2.bias	64	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.4.weight	64	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.4.bias	1	requires_grad=True
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Total # parameters = 3692178
2022-06-29 12:33:08,959 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - --------------------------
2022-06-29 12:33:08,960 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.5-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Epoch 0:
loss error
loss:  3.1249999525760023e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error

Training:   8%|▊         | 16/200 [00:02<00:31,  5.82it/s]
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  6.2499999051520046e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  6.2499999051520046e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error

Training:  14%|█▎        | 27/200 [00:04<00:31,  5.53it/s]
loss error
loss:  4.6874999288640034e+29
loss error
loss:  6.2499999051520046e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  6.2499999051520046e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  7.812500259229324e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  7.812500259229324e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  4.6874999288640034e+29
loss error
loss:  3.1249999525760023e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
loss:  1.5624999762880011e+29
loss error
