Model directory exists: D:\Documents\codes\python\KnowledgeGraph\LinkPredict\SAC_KGR\model\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0
2022-06-29 12:33:36,845 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - {'process_data': False, 'train': True, 'inference': False, 'run_analysis': True, 'data_dir': '../data/FB15K-237_20', 'model_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\model\\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0', 'model_root_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\model', 'log_dir': 'D:\\Documents\\codes\\python\\KnowledgeGraph\\LinkPredict\\SAC_KGR\\log', 'checkpoint_path': None, 'gpu': 0, 'seed': 543, 'best_dev_metrics': 0.0, 'add_reverse_relations': True, 'add_reversed_training_edges': False, 'emb_dropout_rate': 0.3, 'group_examples_by_query': False, 'entity_dim': 100, 'relation_dim': 100, 'history_dim': 200, 'history_num_layers': 3, 'use_action_space_bucketing': True, 'bucket_interval': 10, 'test': False, 'learning_rate': 0.001, 'actor_learning_rate': 0.001, 'critic_learning_rate': 0.001, 'eof_learning_rate': 0.001, 'num_epochs': 2, 'num_wait_epochs': 100, 'num_peek_epochs': 2, 'start_epoch': 0, 'train_batch_size': 4, 'eval_batch_size': 32, 'buffer_batch_size': 64, 'train_freq_value': 3, 'train_freq_unit': 'episode', 'gradient_steps': 3, 'grad_norm': 0.0, 'xavier_initialization': True, 'hidden_dropout_rate': 0.3, 'feat_dropout_rate': 0.2, 'emb_2D_d1': 10, 'emb_2D_d2': 10, 'num_out_channels': 32, 'kernel_size': 3, 'label_smoothing_epsilon': 0.1, 'num_negative_samples': 100, 'conve_state_dict_path': '../model/FB15K-237_20-embed.conve-RV-100-100-0.003-2-100/model_best.tar', 'theta': 0.2, 'model_name': 'rl.dqn', 'num_rollouts': 3, 'num_rollout_steps': 3, 'bandwidth': 400, 'relation_only': True, 'policy_class': 'DQNPolicy', 'baseline': 'na', 'ff_dropout_rate': 0.1, 'rnn_dropout_rate': 0.0, 'action_dropout_rate': 0.0, 'activation_fn': 'relu', 'net_arch': [64, 64], 'verbose': 0, 'exploration_initial_eps': 1.0, 'exploration_final_eps': 0.05, 'exploration_fraction': 0.1, 'buffer_size': 2880, 'replay_buffer_class': 'ReplayBuffer', 'beta': 0.0, 'gamma': 1, 'tau': 0.005, 'learning_starts': 3, 'target_update_interval': 1, 'ent_coef': 'auto_0.01', 'share_features_extractor': False, 'target_entropy': 'auto', 'n_critics': 1, 'fn_state_dict_path': '', 'fn_kg_state_dict_path': '', 'reward_shaping_threshold': 0, 'mu': 1.0, 'beam_size': 2, 'mask_test_false_negatives': False, 'visualize_paths': False, 'save_beam_search_paths': False, 'remark': '0', 'device': device(type='cuda', index=0)}
** Create rl.dqn knowledge graph **
Sanity check: 14543 entities loaded
Sanity check: 477 relations loaded
Sanity check: maximum out degree: 1459
Sanity check: 108846 facts in knowledge graph
Sanity check: 106444 facts saved in action table
Vectorizing action spaces bucket 1...
Vectorizing action spaces bucket 41...
Vectorizing action spaces bucket 37...
Vectorizing action spaces bucket 27...
Vectorizing action spaces bucket 40...
Vectorizing action spaces bucket 39...
Vectorizing action spaces bucket 16...
Vectorizing action spaces bucket 36...
Vectorizing action spaces bucket 18...
Vectorizing action spaces bucket 19...
Vectorizing action spaces bucket 20...
Vectorizing action spaces bucket 21...
Vectorizing action spaces bucket 14...
Vectorizing action spaces bucket 15...
Vectorizing action spaces bucket 23...
Vectorizing action spaces bucket 12...
Vectorizing action spaces bucket 13...
Vectorizing action spaces bucket 11...
Vectorizing action spaces bucket 9...
Vectorizing action spaces bucket 10...
Vectorizing action spaces bucket 8...
Vectorizing action spaces bucket 7...
Vectorizing action spaces bucket 6...
Vectorizing action spaces bucket 5...
Vectorizing action spaces bucket 4...
Vectorizing action spaces bucket 3...
Vectorizing action spaces bucket 2...
Training:   0%|          | 0/200 [00:00<?, ?it/s]
========================== LFramework ==========================
model_name:  rl.dqn
start_epoch:  0
num_epochs:  2
train_batch_size:  4
eval_batch_size:  32
num_rollouts:  3
beam_size:  2
run_analysis:  True
num_peek_epochs:  2
num_wait_epochs:  100
use_action_space_bucketing:  True
========================== MLPFeaturesExtractor ==========================
_action_dim:  200
_history_dim:  200
_features_dim:  200
_state_dim:  300
_history_num_layers:  3
_xavier_initialization:  True
ff_dropout_rate:  0.1
========================== MLPFeaturesExtractor ==========================
_action_dim:  200
_history_dim:  200
_features_dim:  200
_state_dim:  300
_history_num_layers:  3
_xavier_initialization:  True
ff_dropout_rate:  0.1
800 triples loaded from ../data/FB15K-237_20\train.txt
500 triples loaded from ../data/FB15K-237_20\dev.txt
2022-06-29 12:33:52,460 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] -
Model Parameters
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - --------------------------
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - kg.entity_embeddings.weight	1454300	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - kg.relation_embeddings.weight	47700	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W1.weight	60000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W1.bias	200	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W2.weight	40000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.W2.bias	200	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l0	160000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l0	160000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l0	800	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l0	800	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l1	160000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l1	160000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l1	800	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l1	800	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_ih_l2	160000	requires_grad=True
2022-06-29 12:33:52,461 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.weight_hh_l2	160000	requires_grad=True
2022-06-29 12:33:52,462 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_ih_l2	800	requires_grad=True
2022-06-29 12:33:52,462 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.feature_extractor.path_encoder.bias_hh_l2	800	requires_grad=True
2022-06-29 12:33:52,462 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.0.weight	25600	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.0.bias	64	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.2.weight	4096	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.2.bias	64	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.4.weight	64	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net.qf0.4.bias	1	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W1.weight	60000	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W1.bias	200	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W2.weight	40000	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.W2.bias	200	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l0	160000	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l0	160000	requires_grad=True
2022-06-29 12:33:52,476 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l0	800	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l0	800	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l1	160000	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l1	160000	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l1	800	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l1	800	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_ih_l2	160000	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.weight_hh_l2	160000	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_ih_l2	800	requires_grad=True
2022-06-29 12:33:52,477 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.feature_extractor.path_encoder.bias_hh_l2	800	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.0.weight	25600	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.0.bias	64	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.2.weight	4096	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.2.bias	64	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.4.weight	64	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - policy.q_net_target.qf0.4.bias	1	requires_grad=True
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Total # parameters = 3692178
2022-06-29 12:33:52,492 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - --------------------------

















Training: 100%|██████████| 200/200 [00:35<00:00,  5.65it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
 75%|███████▌  | 6/8 [00:00<00:00, 13.36it/s]
2022-06-29 12:34:27,873 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - train/current_progress_remaining:   0.5
2022-06-29 12:34:27,873 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - train/exploration_rate:   0.05
2022-06-29 12:34:27,873 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Epoch 0: average training loss = 0.001001707189553634
2022-06-29 12:34:27,873 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: # path types seen = 2350
2022-06-29 12:34:27,874 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: # hits = 16.0 (0.006666666666666667)
2022-06-29 12:34:27,874 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: false negative ratio = 0.0008333333333333334
2022-06-29 12:34:28,473 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance for tail prediction: (correct evaluation)
2022-06-29 12:34:28,516 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 250
2022-06-29 12:34:28,517 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.004
2022-06-29 12:34:28,517 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.004
2022-06-29 12:34:28,517 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.004
2022-06-29 12:34:28,517 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.004
100%|██████████| 8/8 [00:00<00:00, 13.41it/s]
Training:   5%|▌         | 10/200 [00:01<00:34,  5.52it/s]
2022-06-29 12:34:29,113 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance for head prediction: (correct evaluation)
2022-06-29 12:34:29,158 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 250
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.0
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.0
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.0
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.0
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.0
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance: (correct evaluation)
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.002
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.002
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.002
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.002
2022-06-29 12:34:29,159 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.002
2022-06-29 12:34:29,181 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - => best model updated 'D:\Documents\codes\python\KnowledgeGraph\LinkPredict\SAC_KGR\model\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0\model_best.tar'

















Training: 100%|██████████| 200/200 [00:36<00:00,  5.43it/s]
100%|██████████| 8/8 [00:00<00:00, 10.88it/s]
 50%|█████     | 4/8 [00:00<00:00, 10.75it/s]
2022-06-29 12:35:06,027 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - train/current_progress_remaining:   0.0
2022-06-29 12:35:06,027 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - train/exploration_rate:   0.05
2022-06-29 12:35:06,027 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Epoch 1: average training loss = 0.005672831792373927
2022-06-29 12:35:06,027 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: # path types seen = 2249
2022-06-29 12:35:06,027 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: # hits = 119.0 (0.04958333333333333)
2022-06-29 12:35:06,028 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - * Analysis: false negative ratio = 0.0325
2022-06-29 12:35:06,764 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance for tail prediction: (correct evaluation)
2022-06-29 12:35:06,803 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 250
2022-06-29 12:35:06,804 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.004
2022-06-29 12:35:06,804 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.008
2022-06-29 12:35:06,804 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.008
2022-06-29 12:35:06,804 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.008
100%|██████████| 8/8 [00:00<00:00, 10.71it/s]
  3%|▎         | 11/320 [00:01<00:30,  9.98it/s]
2022-06-29 12:35:07,553 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance for head prediction: (correct evaluation)
2022-06-29 12:35:07,591 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 250
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.008
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.012
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.012
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.012
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.01
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Dev set performance: (correct evaluation)
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.006
2022-06-29 12:35:07,592 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.01
2022-06-29 12:35:07,593 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.01
2022-06-29 12:35:07,593 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.01
2022-06-29 12:35:07,593 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.008
2022-06-29 12:35:07,623 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - => best model updated 'D:\Documents\codes\python\KnowledgeGraph\LinkPredict\SAC_KGR\model\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0\model_best.tar'
2022-06-29 12:35:07,624 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - => loading checkpoint from 'D:\Documents\codes\python\KnowledgeGraph\LinkPredict\SAC_KGR\model\FB15K-237_20-rl.dqn-na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0\model_best.tar'
20466 triples loaded from ../data/FB15K-237_20\test.txt














100%|██████████| 320/320 [00:30<00:00, 10.40it/s]















100%|██████████| 320/320 [00:30<00:00, 10.41it/s]
2022-06-29 12:36:10,894 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 10233
2022-06-29 12:36:10,916 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.0028339685331769766
2022-06-29 12:36:10,916 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.004299814326199551
2022-06-29 12:36:10,916 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.004299814326199551
2022-06-29 12:36:10,916 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.004299814326199551
2022-06-29 12:36:10,916 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.0035668914296882633
2022-06-29 12:36:12,550 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - examples size: 10233
2022-06-29 12:36:12,573 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@1 = 0.00244307632170429
2022-06-29 12:36:12,573 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@3 = 0.004104368220463207
2022-06-29 12:36:12,573 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@5 = 0.004104368220463207
2022-06-29 12:36:12,573 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Hits@10 = 0.004104368220463207
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - MRR = 0.0032737222710837485
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Tail Hits@1 = 0.0028339685331769766	Head Hits@1 = 0.00244307632170429	Hits@1 = 0.002638522427440633
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Tail Hits@3 = 0.004299814326199551	Head Hits@3 = 0.004104368220463207	Hits@3 = 0.004202091273331379
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Tail Hits@5 = 0.004299814326199551	Head Hits@5 = 0.004104368220463207	Hits@5 = 0.004202091273331379
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Tail Hits@10 = 0.004299814326199551	Head Hits@10 = 0.004104368220463207	Hits@10 = 0.004202091273331379
2022-06-29 12:36:12,574 - na-100-100-3-2-100-2-3-2880-0.001-0.3-0.1-0.0-1.0-0.05-1-400-0.0-True-False-False-True-0 - [INFO] - Tail MRR = 0.0035668914296882633	Head MRR = 0.0032737222710837485	MRR = 0.003420306850386006